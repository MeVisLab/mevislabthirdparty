diff --git a/CMakeLists.txt b/CMakeLists.txt
index c5c6537..c79dbe6 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -25,7 +25,11 @@ find_package(
 # SKBUILD_SOABI seems to be
 if (DEFINED SKBUILD_SOABI AND NOT "${SKBUILD_SOABI}" STREQUAL "${Python_SOABI}")
   message(WARNING "SKBUILD_SOABI=${SKBUILD_SOABI} != Python_SOABI=${Python_SOABI}; likely cross-compiling or Limited API, using SOABI=${SKBUILD_SOABI} from scikit-build")
-  set(Python_SOABI "${SKBUILD_SOABI}")
+  # the setting is not correct in debug mode, so we use Python_SOABI
+  # and add the debug suffix to the prefix later
+  if (NOT MSVC)
+    set(Python_SOABI "${SKBUILD_SOABI}")
+  endif()
 endif()
 
 # legacy pyzmq env options, no PYZMQ_ prefix
@@ -179,7 +183,8 @@ elseif (NOT ZMQ_PREFIX STREQUAL "bundled")
   )
   find_library(
     LIBZMQ_LIBRARY
-    NAMES zmq
+    # workaround for lib name under Windows
+    NAMES zmq_d zmq zmq-v143-mt-gd-4_3_5 zmq-v143-mt-4_3_5
     PATHS "${ZMQ_PREFIX}/lib"
     NO_DEFAULT_PATH
   )
@@ -389,7 +394,11 @@ if (NOT TARGET "${libzmq_target}" AND LIBZMQ_LIBRARY AND LIBZMQ_INCLUDE_DIR)
   # construct target from find_library results
   # what if it was static?
   add_library(libzmq SHARED IMPORTED)
-  set_property(TARGET libzmq PROPERTY IMPORTED_LOCATION ${LIBZMQ_LIBRARY})
+  if (MSVC)
+    set_property(TARGET libzmq PROPERTY IMPORTED_IMPLIB ${LIBZMQ_LIBRARY})
+  else()
+    set_property(TARGET libzmq PROPERTY IMPORTED_LOCATION ${LIBZMQ_LIBRARY})
+  endif()
   set_property(TARGET libzmq PROPERTY INTERFACE_INCLUDE_DIRECTORIES ${LIBZMQ_INCLUDE_DIR})
 endif()
 
@@ -459,6 +468,11 @@ if(NOT "${SKBUILD_SABI_COMPONENT}" STREQUAL "")
   message(STATUS "Building with stable ABI ${Python_SOABI} for ${SKBUILD_SABI_VERSION}")
 endif()
 
+if (CMAKE_BUILD_TYPE STREQUAL "Debug" AND MSVC)
+  set(ZMQ_EXT_NAME "${ZMQ_EXT_NAME}_d")
+  add_compile_definitions(_DEBUG)
+endif()
+
 python_add_library(
   ${ZMQ_EXT_NAME} MODULE
   WITH_SOABI
