diff --git i/CMakeLists.txt w/CMakeLists.txt
index be94ec7..dfb8e9a 100644
--- i/CMakeLists.txt
+++ w/CMakeLists.txt
@@ -606,7 +606,7 @@ if(WITH_TURBOJPEG)
       set(TJMAPFILE ${CMAKE_CURRENT_SOURCE_DIR}/turbojpeg-mapfile.jni)
     endif()
     if(MSVC)
-      configure_file(${CMAKE_SOURCE_DIR}/win/turbojpeg.rc.in
+      configure_file(${CMAKE_CURRENT_SOURCE_DIR}/win/turbojpeg.rc.in
         ${CMAKE_BINARY_DIR}/win/turbojpeg.rc)
       set(TURBOJPEG_SOURCES ${TURBOJPEG_SOURCES}
         ${CMAKE_BINARY_DIR}/win/turbojpeg.rc)
diff --git i/sharedlib/CMakeLists.txt w/sharedlib/CMakeLists.txt
index e660dc7..c68a765 100644
--- i/sharedlib/CMakeLists.txt
+++ w/sharedlib/CMakeLists.txt
@@ -36,7 +36,7 @@ if(WIN32)
   endif()
 endif()
 if(MSVC)
-  configure_file(${CMAKE_SOURCE_DIR}/win/jpeg.rc.in
+  configure_file(${CMAKE_CURRENT_SOURCE_DIR}/../win/jpeg.rc.in
     ${CMAKE_BINARY_DIR}/win/jpeg.rc)
   set(JPEG_SRCS ${JPEG_SRCS} ${CMAKE_BINARY_DIR}/win/jpeg.rc)
 endif()
